<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Image Editor (At Pixel Level)</title>
		<style>
			body, button, input, h1, p {
				background-color: rgb(40, 40, 40);
				color: white;
			}
		</style>
	</head>
	<body>
		<div id="screen">
			Width: <input id="screen-width" value="32" type="number">px<br>
			Height: <input id="screen-height" value="32" type="number">px<br>
			<button id="screen-create">Start Creating!</button><p id="screen-warning" style="color: red; display: none;"></p>
		</div>
		<script>
const imageWidth = document.getElementById("screen-width"), imageHeight = document.getElementById("screen-height"), create = document.getElementById("screen-create"), warning = document.getElementById("screen-warning"), screen = document.getElementById("screen");

create.onclick = function() {
	const width = +imageWidth.value, height = +imageHeight.value;
	if (isNaN(width) || isNaN(height)) {
		warning.style.display = "";
		warning.textContent = "The image's dimensions are not properly filled in. Default ones will be filled instead.";
		imageWidth.value = 32;
		imageHeight.value = 32;
	} else if (width <= 0 || height <= 0) {
		warning.style.display = "";
		warning.textContent = "The image's dimensions must not be equal to or less than 0! Positive values are accepted though.";
		imageWidth.value = -width;
		imageHeight.value = -height;
	} else if (width !== Math.round(width) || height !== Math.round(height)) {
		warning.style.display = "";
		warning.textContent = "The image's dimensions must be rounded! Otherwise, the pixel data cannot properly be represented!";
		imageWidth.value = Math.round(width);
		imageHeight.value = Math.round(height);
	} else if (width > 128 || height > 128) {
		warning.style.display = "";
		warning.textContent = "It is recommended you try out the main image editor instead of this one, if you want to create large images.";
	} else {
		create.remove();
		imageWidth.remove();
		imageHeight.remove();
		warning.remove();
		screen.textContent = "";
		const canvas = document.createElement("canvas");
		canvas.width = width * 8;
		canvas.height = height * 8;
		screen.appendChild(canvas);
		const context = canvas.getContext("2d");
		const currentImageData = new Uint8ClampedArray(width * height * 8);
		const size = currentImageData.byteLength;
		for (let i = 3; i < size; i += 4) {
			currentImageData[i] = 255;
		}
		const nwidth = width * 8, nheight = height * 8;
		context.fillStyle = "rgb(0, 0, 0)";
		context.fillRect(0, 0, nwidth, nheight);
		function renderImage() {
			for (let y = 0, realY = 0; y < size; y += nheight, realY += 8) {
				const future = y + nheight;
				for (let x = y, realX = 0; x < future; x += 4, realX += 8) {
					context.fillStyle = "rgb(" + String(currentImageData[x]) + "," + String(currentImageData[x + 1]) + "," + String(currentImageData[x + 2]) + ")";
					context.fillRect(realX, realY, 8, 8);
				}
			}
		}
		let bounds = canvas.getBoundingClientRect(), mousedown = false;
		function initInputs() {
			let colorText = document.createElement("a");
			let lineBreak = document.createElement("br");
			screen.appendChild(lineBreak);
			colorText.textContent = "Pixel Color:";
			let colorInput = document.createElement("input");
			colorInput.type = "color";
			screen.appendChild(colorInput);
			return colorInput;
		}
		const pixelColor = initInputs();
		canvas.onmousedown = () => mousedown = true;
		canvas.onmouseup = () => mousedown = false;
		canvas.onmousemove = function(e) {
			if (!mousedown) return;
			const x = Math.floor((e.clientX - canvas.getBoundingClientRect().x) / 8);
			const y = Math.floor((e.clientY - canvas.getBoundingClientRect().y) / 8);
			const pixelIndex = (y * width + x) * 4;
			const col = pixelColor.value;
			const r = parseInt(col.slice(1, 3), 16);
			const g = parseInt(col.slice(3, 5), 16);
			const b = parseInt(col.slice(5, 7), 16);

			currentImageData[pixelIndex] = r;
			currentImageData[pixelIndex + 1] = g;
			currentImageData[pixelIndex + 2] = b;
			currentImageData[pixelIndex + 3] = 255;
			renderImage();
		}
	}
}
		</script>
	</body>
</html>
